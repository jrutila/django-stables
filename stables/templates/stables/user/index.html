{% extends "base.html" %}
{% load i18n stablestags %}
{% block content %}
<h1>
    <span
        {% if object.inactive %}style="text-decoration:line-through"{% endif %}
    >{{ object }}</span>
    {% ifnotequal object.customer object.rider.customer %}
    <small>
    (<a href="{{ object.rider.customer.user.get_absolute_url }}">{{ object.rider.customer.user }}</a>)
    </small>
    {% endifnotequal %}
</h1>

{% if object.instructor %}
<p>
{% trans "Instructor" %}
</p>
{% endif %}

<a class="btn btn-default" href="{% url "edit_user" username=object.user.username %}">{% trans "Edit" %}</a>

<p>
{% trans "E-mail" %}: {{ object.user.email }}
</p>
<p>
{% trans "phone number"|capfirst %}: {{ object.phone_number }}
</p>

{% if object.next and object.next.count > 0 %}
<h3>
  {% trans "Next event" %}
</h3>
  <ul>
  {% for p in object.next %}
    <li>
    {{ p }}
    {% if p %}
    {% participate_button p redirect=object.get_absolute_url %}
    {% endif %}
    </li>
  {% endfor %}
</ul>
{% endif %}

{% if object.participations %}
  <h3>
    {% trans "Last participations" %}
  </h3>
  <ul>
    {% for p in object.participations %}
    <li>
    {{ p }}
    <a href="{% url "view_participation" p.id %}">Edit</a>
    </li>
    {% endfor %}
    <li><a href="{{ request.path }}?pmore={{ object.participations|length|add:10 }}">{% trans "More..." %}</a></li>
  </ul>
{% endif %}

<h3>{% trans "Saldo" %}</h3>
{{ object.saldo }}
<a href="{% url "add_tickets" username=object.user.username %}">{% trans "Add tickets" %}</a>
<a href="{% url "edit_tickets" username=object.user.username %}">{% trans "Edit tickets" %}</a>
<ul>
{% for t, l in object.tickets.iteritems %}
<li class="ticket_valid">
{% blocktrans with name=t amount=l.0 expire_date=l.1 %}
{{ name }}: {{ amount }} pcs (first expires: {{ expire_date }})
{% endblocktrans %}
</li>
{% endfor %}
{% for t, l in object.expired_tickets.iteritems %}
<li class="ticket_expired">
{% blocktrans with name=t amount=l.0 expire_date=l.1 %}
Expired {{ name }}: {{ amount }} pcs (first expired: {{ expire_date }})
{% endblocktrans %}
</li>
{% endfor %}
</ul>

{% if object.transactions %}
<h3>
  {% trans "Last transactions" %}
</h3>
<ul>
  {% for t in object.transactions %}
  <li>
  {{ t }}
  </li>
  {% endfor %}
    <li><a href="{{ request.path }}?tmore={{ object.transactions|length|add:10 }}">{% trans "More..." %}</a></li>
</ul>
{% endif %}

{% endblock %}
